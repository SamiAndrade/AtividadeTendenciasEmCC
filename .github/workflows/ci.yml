
name: CI - BuscaAnimais

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: Build do Projeto
    runs-on: windows-latest

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Restaurar pacotes
      run: dotnet restore

    - name: Build do projeto
      run: dotnet build --configuration Release --no-restore


  #  (SAST) 
  sast:
    name: SAST - CodeQL
    runs-on: windows-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Inicializar CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: csharp

    - name: Compilar o c√≥digo
      run: dotnet build --configuration Release

    - name: Executar an√°lise CodeQL
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:csharp"


  # (DAST) 
You said:
name: CI - BuscaAnimais

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Restaurar pacotes
      run: dotnet restore

    - name: Build do projeto
      run: dotnet build --configuration Release --no-restore Inclua dois n√≥s um para SAST e outro para DAST com respectivas valida√ß√µes
ChatGPT said:
Perfeito üëç Aqui est√° o workflow YAML completo do GitHub Actions com a sua pipeline CI para o projeto BuscaAnimais, incluindo an√°lises SAST (est√°tica) e DAST (din√¢mica).
Usei ferramentas amplamente adotadas e compat√≠veis com GitHub Actions:

SAST: CodeQL (an√°lise de c√≥digo est√°tico).

DAST: OWASP ZAP (teste de seguran√ßa din√¢mica via scan HTTP).

name: CI - BuscaAnimais

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Restaurar pacotes
      run: dotnet restore

    - name: Build do projeto
      run: dotnet build --configuration Release --no-restore

  # üîç An√°lise Est√°tica de Seguran√ßa (SAST) com CodeQL
  sast:
    name: SAST - CodeQL
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write
    steps:
    - name: Checkout do c√≥digo
      uses: actions/checkout@v3

    - name: Inicializar CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: csharp

    - name: Compilar o c√≥digo para an√°lise
      run: dotnet build --configuration Release

    - name: Executar an√°lise CodeQL
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:csharp"

  # üß™ An√°lise Din√¢mica de Seguran√ßa (DAST) com OWASP ZAP
  dast:
    name: DAST - OWASP ZAP
    runs-on: ubuntu-latest
    needs: build
    steps:
    - name: Checkout do c√≥digo
      uses: actions/checkout@v3

    - name: Iniciar aplica√ß√£o (API ou site) para testes
      run: |
        dotnet run --project ./Caminho/Para/SeuProjeto/BuscaAnimais.csproj &
        sleep 15  # tempo para a aplica√ß√£o subir

    - name: Executar OWASP ZAP baseline scan
      uses: zaproxy/action-baseline@v0.12.0
      with:
        target: 'http://localhost:5000'
        rules_file_name: '.zap/rules.tsv'
        cmd_options: '-a'  # modo agressivo opcional
üîß Explica√ß√£o dos novos n√≥s
SAST (CodeQL)
Faz an√°lise est√°tica do c√≥digo C# em busca de vulnerabilidades (SQL Injection, XSS, deserializa√ß√£o insegura etc.).

Pode ser visualizado nos ‚ÄúSecurity ‚Üí Code scanning alerts‚Äù do GitHub.

DAST (OWASP ZAP)
Realiza varredura din√¢mica sobre a aplica√ß√£o em execu√ß√£o.

O campo target deve apontar para o endpoint onde a aplica√ß√£o sobe (por exemplo, http://localhost:5000 ou o endere√ßo de teste configurado).

Se quiser, posso adaptar o workflow para:

rodar SAST e DAST apenas em PRs,

gerar relat√≥rios HTML anexados ao job,

ou integrar com SonarCloud em vez de CodeQL.

Quer que eu configure uma dessas op√ß√µes tamb√©m?

You said:
Todos para Windows 
ChatGPT said:
Perfeito ‚úÖ ‚Äî aqui est√° o workflow GitHub Actions completo, ajustado para que todos os jobs (build, SAST e DAST) sejam executados em Windows (usando windows-latest).

Usei ferramentas compat√≠veis com Windows runners:

SAST: CodeQL (nativo do GitHub, funciona em Windows).

DAST: OWASP ZAP (usando Java no Windows).

name: CI - BuscaAnimais

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: Build do Projeto
    runs-on: windows-latest

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Restaurar pacotes
      run: dotnet restore

    - name: Build do projeto
      run: dotnet build --configuration Release --no-restore


  # üîç An√°lise Est√°tica de Seguran√ßa (SAST) - CodeQL
  sast:
    name: SAST - CodeQL
    runs-on: windows-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Inicializar CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: csharp

    - name: Compilar o c√≥digo
      run: dotnet build --configuration Release

    - name: Executar an√°lise CodeQL
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:csharp"


  # üß™ An√°lise Din√¢mica de Seguran√ßa (DAST) - OWASP ZAP
  dast:
    name: DAST - OWASP ZAP
    runs-on: windows-latest
    needs: build

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v3

    - name: Configurar .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '9.0.x'

    - name: Iniciar aplica√ß√£o para testes
      run: |
        Start-Process -NoNewWindow -FilePath "dotnet" -ArgumentList "run --project ./Caminho/Para/SeuProjeto/BuscaAnimais.csproj"
        Start-Sleep -Seconds 15

    - name: Instalar OWASP ZAP
      run: |
        choco install owasp-zap -y

    - name: Executar varredura OWASP ZAP
      run: |
        zap.bat -cmd -quickurl http://localhost:5000 -quickout zap_report.html

    - name: Upload do relat√≥rio ZAP
      uses: actions/upload-artifact@v3
      with:
        name: zap-report
        path: zap_report.html
üß© Explica√ß√£o dos novos n√≥s
SAST (CodeQL)
Analisa o c√≥digo C# localmente, diretamente no runner Windows.

Resultados aparecem em Security ‚Üí Code scanning alerts no GitHub.

DAST (OWASP ZAP)
Instala o ZAP via Chocolatey (choco).

Executa um scan din√¢mico contra a aplica√ß√£o rodando localmente (http://localhost:5000).

Gera um relat√≥rio zap_report.html anexado como artefato do workflow.

‚úÖ Personaliza√ß√µes poss√≠veis
Posso incluir facilmente:

Gera√ß√£o autom√°tica de relat√≥rio CodeQL em HTML;

Execu√ß√£o paralela ou sequencial dos jobs;

Par√¢metros de alerta de falhas cr√≠ticas (ex: falhar o pipeline se o ZAP encontrar vulnerabilidades de alto risco).

Quer que eu configure o workflow para falhar automaticamente se vulnerabilidades cr√≠ticas forem detectadas (em SAST ou DAST)?

You said:
Current runner version: '2.329.0'
Runner Image Provisioner
Operating System
Runner Image
GITHUB_TOKEN Permissions
Secret source: Actions
Prepare workflow directory
Prepare all required actions
Getting action download info
Error: This request has been automatically failed because it uses a deprecated version of actions/upload-artifact: v3. Learn more: https://github.blog/changelog/2024-04-16-deprecation-notice-v3-of-the-artifact-actions/
ChatGPT said:
Excelente observa√ß√£o üëÄ ‚Äî esse erro ocorre porque o GitHub descontinuou a vers√£o v3 do actions/upload-artifact (e tamb√©m do download-artifact).
Agora, s√≥ as vers√µes v4 e posteriores s√£o aceitas (desde abril de 2024).

Aqui est√° o workflow corrigido e atualizado com o novo padr√£o (‚úÖ compat√≠vel com o runner 2.329.0):

name: CI - BuscaAnimais

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: Build do Projeto
    runs-on: windows-latest

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v4

    - name: Configurar .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '9.0.x'

    - name: Restaurar pacotes
      run: dotnet restore

    - name: Build do projeto
      run: dotnet build --configuration Release --no-restore


  # üîç An√°lise Est√°tica de Seguran√ßa (SAST) - CodeQL
  sast:
    name: SAST - CodeQL
    runs-on: windows-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v4

    - name: Configurar .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '9.0.x'

    - name: Inicializar CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: csharp

    - name: Compilar o c√≥digo
      run: dotnet build --configuration Release

    - name: Executar an√°lise CodeQL
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:csharp"


  # üß™ An√°lise Din√¢mica de Seguran√ßa (DAST) - OWASP ZAP
  dast:
    name: DAST - OWASP ZAP
    runs-on: windows-latest
    needs: build

    steps:
    - name: Checar o reposit√≥rio
      uses: actions/checkout@v4

    - name: Configurar .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '9.0.x'

    - name: Iniciar aplica√ß√£o para testes
      run: |
        Start-Process -NoNewWindow -FilePath "dotnet" -ArgumentList "run --project ./Caminho/Para/SeuProjeto/BuscaAnimais.csproj"
        Start-Sleep -Seconds 15

    - name: Instalar OWASP ZAP
      run: |
        choco install owasp-zap -y

    - name: Executar varredura OWASP ZAP
      run: |
        zap.bat -cmd -quickurl http://localhost:5000 -quickout zap_report.html

    - name: Upload do relat√≥rio ZAP
      uses: actions/upload-artifact@v4
      with:
        name: zap-report
        path: zap_report.html
